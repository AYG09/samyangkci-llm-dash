# 11. 공식 문서 우선주의 및 컴포넌트 역할 명확화

- Dash 및 모든 주요 라이브러리 사용 시, **공식 문서(Documentation)와 릴리즈노트**를 '제1의 신뢰 소스'로 삼는다.
- 새로운 컴포넌트/속성/기능을 도입하거나 오류가 발생할 때, 반드시 공식 문서에서 지원 여부와 사용법을 먼저 확인한다.
- Dash 생태계의 각 컴포넌트 라이브러리(`html`, `dcc`, `dbc` 등)는 **역할과 경계**가 명확하므로, 구조(HTML)는 `html`, 상호작용/렌더링은 `dcc`, 스타일/레이아웃은 `dbc`로 구분하여 사용한다.
- 구조용 컴포넌트에 렌더링/상호작용 속성을 혼용하지 않는다. (예: `html.Div`에 HTML 문자열 렌더링 속성 사용 금지)
- 공식 문서/릴리즈노트 기반으로 코드/구조를 최신화하고, 문서에 없는 속성/기능은 사용하지 않는다.

#### 실천 예시
- 오류 발생 시, 해당 컴포넌트의 공식 문서에서 지원 속성/용법을 먼저 확인한다.
- HTML 문자열 렌더링이 필요하면 `dcc.Markdown` 또는 최신 Dash의 `dangerouslySetInnerHTML`을 사용한다.
- 구조/스타일/상호작용의 책임을 명확히 분리하여, 역할에 맞는 컴포넌트만 사용한다.
# 삼양KCI LLM 연동 면접 분석 시스템 개발 7원칙

## 🚨 개발 시 반드시 준수해야 할 원칙들

### 1. 대형 모놀리식 .py 파일을 피한다

- **기준**: 모든 .py 파일 150줄 이하 (메인 파일뿐만 아니라 모든 파일)
- **체크 방법**: `check_principles.bat` 실행으로 자동 확인
- **조치**: 150줄 초과 시 즉시 분리하여 모듈화

### 2. 조기에 모듈화/리팩토링을 준비한다

- app/ 디렉토리 구조 활용
- 기능별 모듈 분리

### 3. 코드가 너무 커지면 새로운 .py를 생성하고 기존 것을 삭제한다

- 적절한 크기 유지
- 기능별 책임 분리

### 4. Windows에서는 모든 Python/pip install/run 명령에 py.exe를 사용한다 (로컬 개발 환경 한정)

- (로컬 개발 환경 한정) py -m pip install, py -m streamlit run, 배치 파일에서 py.exe 사용
- 운영/배포 환경에서는 해당 플랫폼에 맞는 실행법을 병기한다.

### 5. Windows PowerShell 기준 명령어를 사용한다 (로컬 개발 환경 한정)

- (로컬 개발 환경 한정) `&&` 대신 `;` 또는 개별 명령 사용
- `echo` 대신 `Write-Host` 또는 PowerShell 호환 명령
- 운영/배포 환경에서는 bash/sh 등도 병기한다.
- AI 에이전트는 PowerShell 문법으로 명령어 작성

### 6. 공통 UI/로직 단일화 원칙

- 공통 UI/로직은 반드시 단일 컴포넌트(모듈)로 분리·관리하고, 직접적인 코드 중복 구현을 금지한다.
- 변경 시 전체 시스템에 일관되게 반영되어야 한다.
- 버튼, 안내문, 카드, LLM 연동 등 공통 UI/로직은 반드시 하나의 파일/함수/클래스에서만 정의한다.
- 각 탭/화면에서는 해당 공통 컴포넌트만 import해서 사용한다.
- 직접 복사/붙여넣기 방식의 중복 구현은 금지하며, 변경이 필요할 때는 반드시 공통 컴포넌트만 수정한다.

### 7. dash 및 주요 라이브러리 버전 호환성/최신 문법 준수

- dash, dash_table 등 주요 라이브러리는 항상 최신 버전 호환성 및 문법을 준수한다.
- suppress_callback_exceptions, DataTable 등 dash 정책 변경 시 즉시 구조/코드 반영.
- 공식 문서/릴리즈노트 기반으로 코드/구조를 최신화한다.

### 8. ai agent가 자동완성한다

- 반복적·표준적 코드, 구조, 문서화, 리팩토링, 버전 호환 등은 ai agent(코파일럿 등)가 자동으로 제안·완성한다.
- 개발자는 핵심 로직·비즈니스·UX에 집중하고, 반복적·형식적 작업은 ai agent에 위임한다.
- ai agent의 제안은 반드시 검토·수정·승인 후 반영한다.
- ai agent는 반복적/표준적 문제는 자동으로 처리하며, 핵심 의사결정이 필요한 경우에만 사용자에게 질문한다.

#### 자동 적용 예시
- DataTable 등 반복적 UI/로직의 삭제, 정렬, 필터, 페이지 상태 동기화 문제는 ai agent가 자동으로 개선안을 제안·적용한다.
- 예: 삭제 후 DataTable의 필터/정렬/페이지 상태를 자동 초기화하여 남은 row가 항상 보이도록 처리.

### 9. 디자인 원칙을 실질적으로 적용한다

- 사람 중심, 신뢰, 단순함, 브랜드 일관성, 피드백, 접근성 등 디자인 원칙을 모든 UI/UX와 코드에 실질적으로 반영한다.
- 모든 화면/컴포넌트/로직은 사용성, 신뢰성, 일관성, 접근성, 피드백 제공을 최우선으로 설계·구현한다.
- 디자인 원칙은 코드 리뷰, UI/UX 개선, 신규 기능 개발 시 반드시 체크리스트로 활용한다.

#### 실사용자 경험 개선 예시
- 삭제, 비교, 다운로드 등 주요 액션 후에는 반드시 안내 메시지(예: "삭제된 항목을 제외한 나머지 데이터가 정상적으로 남아있습니다")를 제공하여 사용자 불안을 해소한다.
- id 혼란 방지를 위해 화면에 '순번' 컬럼을 추가하여 1번부터 연속된 번호로 보여준다.

### 10. dash 앱 특화 개발원칙

- 콜백 함수는 반드시 단일 책임 원칙(SRP)을 지킨다.
- 레이아웃, 컴포넌트, 콜백은 분리·재사용성을 극대화한다.
- dcc.Store 등 상태관리 컴포넌트와 Output/State 동기화를 명확히 한다.
- 모든 UI/UX에는 로딩, 에러, 안내 등 피드백을 제공한다.
- dash 공식 문서/릴리즈노트 기반 구조·문법을 항상 최신화한다.

#### dash 자동 적용 예시
- 삭제 후 DataTable의 page_current=0 등 상태를 리셋하여 남은 row가 항상 첫 페이지에 보이도록 한다.
- DataTable에 "순번" 컬럼을 추가하여 id와 별개로 연속 번호를 제공한다.
- 삭제 후 안내 메시지 강화: "1명 삭제 완료. 남은 데이터가 정상적으로 표시됩니다." 등 실시간 피드백 제공.

### 11. 외부 데이터/JSON 접근 시 방어적 코딩 원칙

- dict, JSON 등 외부 데이터 접근 시 KeyError 방지를 위해 항상 .get() 또는 try-except를 사용한다.
- LLM, DB, API 등에서 key 누락/불완전 데이터가 빈번하므로, 기본값을 명시하거나 예외 발생 시 안내 메시지를 제공한다.
- 모든 컴포넌트/함수에서 dict 접근 시 .get() 사용을 습관화한다.
- 공통 데이터 파싱/전처리 계층에서 key 보장 또는 기본값 처리를 우선 적용한다.
- 사용자에게는 에러 대신 안내 메시지/대체 UI를 제공하여 신뢰성과 사용성을 높인다.

#### 실천 예시
- for item in data["분석항목"]: → for item in data.get("분석항목", []):
- item["title"] → item.get("title", "-")
- 데이터가 없을 때는 Alert, 빈 리스트 등으로 graceful degradation

### 12. DB 저장/불러오기 및 JSON 데이터 일관성 원칙

- DB에 저장하는 모든 JSON 데이터(raw_result 등)는 반드시 `json.dumps()`로 직렬화한 순수 JSON 문자열만 저장한다.
- 마크다운 코드블록(``` 등), str(dict) 결과, 불필요한 escape 문자 등은 저장 금지. 저장 전 자동 정제(cleaning) 필수.
- 불러올 때는 항상 `json.loads()`로 역직렬화하며, 파싱 실패 시 안내 메시지 및 로깅을 제공한다.
- 이미 저장된 데이터에 불필요한 문자가 포함된 경우, 정제(cleanup) 스크립트로 일괄 정리 후 재저장한다.
- 저장/불러오기 로직에서 일관성 있게 json.dumps/json.loads만 사용하며, 예외 상황(파싱 실패 등)도 graceful하게 처리한다.
- 데이터 일관성/방어적 코딩 원칙을 모든 데이터 입출력 계층에 적용한다.

#### 실천 예시
- 저장: `raw_result=json.dumps(obj, ensure_ascii=False)`
- 불러오기: `json.loads(clean_json_string(raw_result))`
- 이미 저장된 데이터 정제: cleanup_all_raw_results() 등 스크립트 활용
- 파싱 실패 시: 사용자 안내 및 로그 기록, 원본 데이터 보존

## 체크포인트

- [x] 모든 .py 파일 150줄 이하
- [x] app/ 모듈 활용
- [x] py.exe 명령 사용
- [x] 기능별 책임 분리
- [x] PowerShell 기준 명령어
- [x] 공통 UI/로직 단일화
- [x] dash 및 주요 라이브러리 버전 호환성/최신 문법
- [ ] dash 및 주요 라이브러리 버전 호환성/최신 문법 준수

## 자동화 도구

- `check_principles.bat` - 7원칙 준수 상태 자동 체크
- `run_app.bat` - py.exe 사용하여 앱 실행

**마지막 체크**: `check_principles.bat` 실행으로 자동 확인 ⚡
